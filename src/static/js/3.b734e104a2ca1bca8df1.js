webpackJsonp([3],{Cdx3:function(e,t,a){var r=a("sB3e"),o=a("lktj");a("uqUo")("keys",function(){return function(e){return o(r(e))}})},QPgU:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Gu7T"),o=a.n(r),s=a("fZjL"),i=a.n(s),n=a("mSl6"),l=a("uXZL"),c=a.n(l),m=a("PJh5"),d=a.n(m),p={1:"今天",2:"昨天",3:"本周",4:"上周",5:"本月",6:"上月",7:"自定义"},u=864e5,h={name:"record",data:function(){return{paydateRange:[],dateRange:[],searchForm:{storeId:null,outTradeNo:null,token:null,state:"0",time:"1",storename:"",startTime:null,endTime:null},lastForm:{},result:[],page:{currentPage:0,pageCount:0,pageSize:0,total:0},options:{times:i()(p).map(function(e){return{value:e,name:p[e]}}),states:i()(n.a).map(function(e){return{value:e,name:n.a[e]}})},pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){var t=new Date,a=new Date;e.$emit("pick",[a,t])}},{text:"昨天",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-u),t.setTime(t.getTime()-u),e.$emit("pick",[a,t])}},{text:"本周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-u*(a.getDay()-1)),e.$emit("pick",[a,t])}},{text:"上周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-u*(a.getDay()+6)),t.setTime(t.getTime()-u*t.getDay()),e.$emit("pick",[a,t])}},{text:"本月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-u*(a.getDate()-1)),e.$emit("pick",[a,t])}},{text:"上月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-u*a.getDate()),a.setTime(a.getTime()-u*(a.getDate()-1)),t.setTime(t.getTime()-u*t.getDate()),e.$emit("pick",[a,t])}}]},map:{stateTag:n.b,states:n.a},storeList:[],allStore:[{name:"全部",id:""}],loading2:!1}},created:function(){this.getOrders({page:this.page.currentPage}),this.getStore()},activated:function(){this.getOrders({page:this.page.currentPage})},methods:{resetSearchForm:function(){this.$refs.searchFormRef.resetFields(),this.searchForm.storeId=null,this.searchForm.outTradeNo=null,this.searchForm.token=null,this.searchForm.storename="",this.paydateRange=[],this.lastForm={},this.getOrders()},searchOrders:function(){var e={};if(this.searchForm.state&&0!=this.searchForm.state&&(e.state=this.searchForm.state),this.searchForm.outTradeNo&&(e.outTradeNo=this.searchForm.outTradeNo),this.searchForm.storeId&&(e.storeId=this.searchForm.storeId),this.searchForm.token&&(e.token=this.searchForm.token),this.searchForm.payTimeStart&&(e.payTimeStart=this.searchForm.payTimeStart),this.searchForm.payTimeEnd&&(e.payTimeEnd=this.searchForm.payTimeEnd+" 23:59:59"),e.state&&2==e.state&&this.searchForm.time&&(e.time=this.searchForm.time),7==e.time){if(!this.dateRange)return void this.$message({message:"请选择日期范围",type:"warning"});if(!this.dateRange[0]||!this.dateRange[1])return void this.$message({message:"请选择日期范围",type:"warning"});e.startTime=this.dateRange[0],e.endTime=this.dateRange[1]}this.lastForm=e,this.getOrders()},exportExcel:function(){var e=this,t={};if(this.searchForm.state&&0!=this.searchForm.state&&(t.state=this.searchForm.state),this.searchForm.outTradeNo&&(t.outTradeNo=this.searchForm.outTradeNo),this.searchForm.storeId&&(t.storeId=this.searchForm.storeId),this.searchForm.token&&(t.token=this.searchForm.token),this.paydateRange&&(t.payTimeStart=this.paydateRange[0],t.payTimeEnd=this.paydateRange[1]),t.state&&2==t.state&&this.searchForm.time&&(t.time=this.searchForm.time),7==t.time){if(!this.dateRange)return void this.$message({message:"请选择日期范围",type:"warning"});if(!this.dateRange[0]||!this.dateRange[1])return void this.$message({message:"请选择日期范围",type:"warning"});t.startTime=this.dateRange[0],t.endTime=this.dateRange[1]}var a={page:1,size:99999999},r=i()(t);r.length>0&&r.map(function(e){a[e]=t[e]}),this.loading2=!0,this.$axios.get("/seller/list",{params:a}).then(function(t){0==t.data.code?e._exportExcel(t.data.page.list):e.$message({message:t.data.msg,type:"error"})})},_exportExcel:function(e){var t=this;this.loading2=!1;var a=e.map(function(e){return[e.outTradeNo,e.user?e.user.vipCode:void 0,e.couponName,e.token,t.map.states[e.state],e.brandName,e.store,e.payTime,e.useTime,e.refundTime,e.originalFee.toFixed(2),(e.originalFee-e.totalFee+e.brandAllocation).toFixed(2),(e.totalFee-e.brandAllocation).toFixed(2),(e.couponFee-e.brandAllocation).toFixed(2),e.redpacketUsedFee.toFixed(2),106==e.state||108==e.state?(0).toFixed(2):(e.payPrice+e.wechatRedpacketFee).toFixed(2),106==e.state||108==e.state?(e.payPrice+e.wechatRedpacketFee).toFixed(2):(0).toFixed(2)]}),r=[["订单号","会员号","优惠券名称","券号","状态","品牌名称","门店名称","支付时间","使用时间","退款时间","券面原价(元)","商家优惠(元)","订单原价(元)","银行补贴(元)","银行红包(元)","客户实付(元)","退款金额(元)"]].concat(a),o=c.a.utils.aoa_to_sheet(r);o["!cols"]=[{wpx:170},{wpx:80},{wpx:200},{wpx:80},{wpx:150},{wpx:120},{wpx:200},{wpx:160},{wpx:160},{wpx:160},{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:100}];for(var s=0;s<e.length;s++)o[c.a.utils.encode_cell({c:10,r:s+1})].t="n",o[c.a.utils.encode_cell({c:11,r:s+1})].t="n",o[c.a.utils.encode_cell({c:12,r:s+1})].t="n",o[c.a.utils.encode_cell({c:13,r:s+1})].t="n",o[c.a.utils.encode_cell({c:14,r:s+1})].t="n",o[c.a.utils.encode_cell({c:15,r:s+1})].t="n",o[c.a.utils.encode_cell({c:16,r:s+1})].t="n";var i=c.a.utils.book_new();c.a.utils.book_append_sheet(i,o),c.a.writeFile(i,"订单详情-"+d()(new Date).format("YYYYMMDD")+".xlsx")},changePage:function(e){var t={page:e};this.getOrders(t)},getOrders:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1,size:10},a=i()(this.lastForm);a.length>0&&a.map(function(a){t[a]=e.lastForm[a]}),t.page||(t.page=1),t.size||(t.size=10),this.$axios.get("/seller/list",{params:t}).then(function(t){0==t.data.code?(e.result=t.data.page.list,e.page={pageCount:t.data.page.totalPage,currentPage:t.data.page.currPage,pageSize:t.data.page.pageSize,total:t.data.page.totalCount}):e.$message({message:t.data.msg,type:"error"})})},getStore:function(){var e=this,t=this.$route.query.brandId;this.$route.query.brandId?this.$axios.get("/seller/storeList/"+t).then(function(t){0==t.data.code?e.storeList=[].concat(o()(e.allStore),o()(t.data.data)):e.$message({message:t.data.msg,type:"error"})}):this.storeList=[].concat(o()(this.allStore))},selectStore:function(e){var t;t=this.storeList.find(function(t){return t.id===e}),this.searchForm.storeId=t.id}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],staticClass:"height",attrs:{"element-loading-text":"下载中,请稍等...","element-loading-background":"rgba(245, 245, 245, 0.5)"}},[a("el-form",{ref:"searchFormRef",attrs:{inline:"",model:e.searchForm}},[a("el-form-item",{attrs:{label:"状态",prop:"state"}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.searchForm.state,callback:function(t){e.$set(e.searchForm,"state",t)},expression:"searchForm.state"}},e._l(e.options.states,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.searchForm.state,expression:"searchForm.state == 2"}],attrs:{label:"使用时间",prop:"state"}},[a("el-select",{model:{value:e.searchForm.time,callback:function(t){e.$set(e.searchForm,"time",t)},expression:"searchForm.time"}},e._l(e.options.times,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.searchForm.state&&7==e.searchForm.time,expression:"searchForm.state == 2 && searchForm.time == 7"}]},[a("el-date-picker",{attrs:{type:"daterange","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd-HH-mm-ss","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"门店",prop:"shop"}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:e.selectStore},model:{value:e.searchForm.storename,callback:function(t){e.$set(e.searchForm,"storename",t)},expression:"searchForm.storename"}},e._l(e.storeList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"订单号",prop:"order"}},[a("el-input",{model:{value:e.searchForm.outTradeNo,callback:function(t){e.$set(e.searchForm,"outTradeNo","string"==typeof t?t.trim():t)},expression:"searchForm.outTradeNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"劵号",prop:"coupon"}},[a("el-input",{model:{value:e.searchForm.token,callback:function(t){e.$set(e.searchForm,"token","string"==typeof t?t.trim():t)},expression:"searchForm.token"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"支付开始时间",prop:"startTime"}},[a("el-date-picker",{staticStyle:{width:"150px"},attrs:{clearable:"","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.payTimeStart,callback:function(t){e.$set(e.searchForm,"payTimeStart",t)},expression:"searchForm.payTimeStart"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"支付结束时间",prop:"endTime"}},[a("el-date-picker",{staticStyle:{width:"150px"},attrs:{clearable:"","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.payTimeEnd,callback:function(t){e.$set(e.searchForm,"payTimeEnd",t)},expression:"searchForm.payTimeEnd"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.searchOrders}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:e.resetSearchForm}},[e._v("重置")]),e._v(" "),a("el-button",{on:{click:e.exportExcel}},[e._v("导出Excel")])],1)],1),e._v(" "),a("el-table",{staticClass:"seller-record-table",staticStyle:{border:"1px solid #eee","overflow-x":"scroll"},attrs:{data:e.result,stripe:"",size:"medium"}},[a("el-table-column",{attrs:{label:"订单号",prop:"outTradeNo",width:"170px"}}),e._v(" "),a("el-table-column",{attrs:{label:"会员号",prop:"user.vipCode",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{label:"优惠券名称",prop:"couponName",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.couponName}},[e._v(e._s(t.row.couponName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"券号",prop:"token",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.map.stateTag[t.row.state]}},[e._v(e._s(e.map.states[t.row.state]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"品牌名称",prop:"brandName",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.brandName}},[e._v(e._s(t.row.brandName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"门店名称",prop:"store",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.store}},[e._v(e._s(t.row.store))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"支付时间",prop:"payTime",width:"160px"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用时间",prop:"useTime",width:"160px"}}),e._v(" "),a("el-table-column",{attrs:{label:"退款时间",prop:"refundTime",width:"160px"}}),e._v(" "),a("el-table-column",{attrs:{label:"券面原价(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.originalFee}},[e._v(e._s(t.row.originalFee.toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"商家优惠(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.totalFee}},[e._v(e._s((t.row.originalFee-t.row.totalFee+t.row.brandAllocation).toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单原价(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.totalFee}},[e._v(e._s((t.row.totalFee-t.row.brandAllocation).toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"银行补贴(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.couponFee}},[e._v(e._s((t.row.couponFee-t.row.brandAllocation).toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"银行红包(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.redpacketUsedFee}},[e._v(e._s(t.row.redpacketUsedFee.toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"客户实付(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.payPrice}},[e._v(e._s(106==t.row.state||108==t.row.state?(0).toFixed(2):(t.row.payPrice+t.row.wechatRedpacketFee).toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"退款金额(元)",width:"120px",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{attrs:{title:t.row.payPrice}},[e._v(e._s(106==t.row.state||108==t.row.state?(t.row.payPrice+t.row.wechatRedpacketFee).toFixed(2):(0).toFixed(2)))])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-div"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-count":e.page.pageCount,currentPage:e.page.currentPage,pageSize:e.page.pageSize,total:e.page.total},on:{"current-change":e.changePage}})],1)],1)},staticRenderFns:[]};var f=a("VU/8")(h,g,!1,function(e){a("jQya"),a("arbP")},"data-v-0138c534",null);t.default=f.exports},arbP:function(e,t){},fZjL:function(e,t,a){e.exports={default:a("jFbC"),__esModule:!0}},jFbC:function(e,t,a){a("Cdx3"),e.exports=a("FeBl").Object.keys},jQya:function(e,t){},mSl6:function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return o});var r={0:"全部",1:"待使用",2:"已使用",4:"已过期",101:"待支付",102:"支付中",103:"待使用(已支付)",105:"退款中(原因：过期)",106:"已退款(原因：过期)",107:"退款中(原因：申请退款)",108:"已退款(原因：申请退款)"},o={1:"",2:"success",4:"warning",101:"info",102:"info",103:"info",105:"danger",106:"danger",107:"warning",108:"warning"}},uqUo:function(e,t,a){var r=a("kM2E"),o=a("FeBl"),s=a("S82l");e.exports=function(e,t){var a=(o.Object||{})[e]||Object[e],i={};i[e]=t(a),r(r.S+r.F*s(function(){a(1)}),"Object",i)}}});